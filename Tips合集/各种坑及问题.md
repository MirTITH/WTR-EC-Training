# 各种坑及问题

## HAL 的坑
### HAL_Delay
`HAL_Delay(time)` 实际上延时 (time+1) ms. 

因此 `HAL_Delay(1)` 实际延时 2 ms, `HAL_Delay(0)` 实际延时 1 ms.

```c
__weak void HAL_Delay(uint32_t Delay)
{
  uint32_t tickstart = HAL_GetTick();
  uint32_t wait = Delay;

  /* Add a freq to guarantee minimum wait */
  if (wait < HAL_MAX_DELAY)
  {
    wait += (uint32_t)(uwTickFreq); // 这句导致延时多了 1 ms
  }

  while ((HAL_GetTick() - tickstart) < wait)
  {
  }
}
```
