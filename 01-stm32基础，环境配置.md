# 01-stm32基础，环境配置

## 软件——从安装到卸载

### STM32CubeMX

官网上的需要注册，觉得麻烦可以使用群里的安装包

安装完后可以更新到最新版本

### git

### VS Code

#### 本体

<https://code.visualstudio.com/>

记得添加右键菜单，可以提高生活质量

可以打开设置同步，多端同步，重装不愁

#### 插件

- C/C++
- Chinese
- Cortex-Debug
- Embedded IDE 
- Markdown All in One
- Markdown Preview Github Styling
- Git History

#### 设置

```json
"editor.insertSpaces": false,
"files.autoGuessEncoding": true,
"editor.mouseWheelZoom": true,
"security.workspace.trust.enabled": false,
"cortex-debug.showRTOS": true,
"EIDE.SourceTree.AutoSearchIncludePath": true,
"EIDE.ARM.Option.AxfToElf": true,
```

> GDB 对 elf 文件支持较好

### Keil

付费软件，可以使用群里的安装包

### 卸载

装上了还想卸载？

## 新建 stm32 工程

使用 CubeMX

配置：

- RCC
- SYS-Debug: SW
- 时钟树
- 其他外设

工程设置：

- MDK 或 CubeIDE (Generate Under Root)
- Copy only the necessary...
- Generate ... per peripheral

### GCC 构建器选项

打印浮点数
```
-u _printf_float
```

## 构建、烧录、调试

硬件连接：

	电脑 <-> 调试器(debugger) <-> MCU

烧录（下载）：

	代码 ---编译器、链接器---> .elf(.axf) ----OpenOCD、PyOCD等---> 调试器 --> MCU

Debug: 

1. OpenOCD 连接调试器，开启本地监听端口
2. gdb 连接到 OpenOCD 的端口
3. gdb 结合 .elf 和代码文件开始调试

## 一些有用的文档

EIDE <https://em-ide.com/zh-cn/docs/intro/>

时钟树 <https://zhuanlan.zhihu.com/p/339529771>

STM32F40x 外设时钟树（其他型号也差不多） <https://blog.csdn.net/chenhuanqiangnihao/article/details/113331335>

Git 教程 <https://www.runoob.com/git/git-tutorial.html>
