FSM:
https://blog.csdn.net/benjonc/article/details/79870947